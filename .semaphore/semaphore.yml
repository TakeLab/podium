version: v1.0
name: CI tests for TakeLab podium

agent:
  machine:
    type: e1-standard-2

    containers:
      - name: main
        image: semaphoreci/python:3.6.0

blocks:
  - name: run tests
    task:
      jobs:
        - name: pytest
          commands:
            - checkout
            - python -m venv venv
            - source venv/bin/activate
            - pip install .[tests]
            - pytest tests

  - name: check code quality
    task:
      jobs:
        - name: black isort flake8
          commands:
            - checkout
            - sudo pip install .[quality]
            - black --check --line-length 90 --target-version py36 podium tests examples
            - isort --check-only podium test examples
            - flake8 podium test examples

# add build/deploy docs on stable relase
