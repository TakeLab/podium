version: v1.0
name: Unit tests for takepod
agent:
  machine:
    type: e1-standard-2
    os_image: ubuntu1804
blocks:
  - name: Python
    task:
      jobs:
        - name: Create env and run tests and flake8 check
          commands:
            - 'python -c ''print("evol"[::-1])'''
            - sudo apt-get update
            - >-
              sudo apt-get install -y python3-pip python3-dev ipython3
              build-essential python-dev
            - checkout
            - virtualenv env -p /usr/bin/python3
            - source env/bin/activate
            - python --version
            - pip install -r requirements.txt
            - py.test --cov-report=term-missing --cov=takepod
            - flake8 takepod
            - flake8 test
